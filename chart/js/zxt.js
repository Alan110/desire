define(function(){function t(e){return-1*(e+1)}function r(e){return e*this.cfg.tScale}function i(e){var n=this.cfg,r=e.x*n.unitWidth+n.startX,i=t(e.y*n.unitHeight/n.yUnit);return{x:r,y:i}}function s(e){var t=this.cfg,n=e.reduce(function(e,t){return e.y=t.y>e.y?t.y:e.y,e.x=t.x>e.x?t.x:e.x,e},{x:0,y:0}),r=n.x/t.xlen,i=n.y/t.ylen,s=Math.pow(10,parseInt(r).toString().length-1),o=Math.pow(10,parseInt(i).toString().length-1);return{x:Math.ceil(r/s)*s,y:Math.ceil(i/o)*o}}function o(){var n=this.canvas,i=this.canvasWraper,o=this.ctx,u=r.bind(this);e=this.cfg,self=this,r=u,this.canvas.width=r(i.offsetWidth),this.canvas.height=r(i.offsetHeight),this.canvas.style.cssText="width:100%;height:100%;",["offsetKeduY","keduHeight","offsetX","offsetY","pointR","unitHeight","startX","fontSize","offsetKeduX"].forEach(function(t,n){self.cfg[t]=r(e[t])}),this.cfg.unitWidth=(n.width-2*e.startX)/e.xlen;var a=e.lines.reduce(function(e,t){return e.concat(t.points)},[]),f=s.call(this,a);this.cfg.xUnit=f.x,this.cfg.yUnit=f.y,o.translate(e.offsetX,n.height+t(e.offsetY)),o.textAlign="end",o.textBaseline="middle",o.font=e.fontSize+"px"+" Arial, Helvetica, sans-serif lighter",o.lineWidth=r(e.lineWidth)}function u(){var n=this.ctx,r=this.canvas;n.strokeStyle="#f1f1f1",n.fillStyle="#666666";for(var i=0;i<e.ylen+1;i++){n.beginPath();var s=t(i*e.unitHeight);n.moveTo(0,s),n.lineTo(r.width,s),i!==0&&n.fillText(i*e.yUnit,-1*e.offsetKeduX,s),n.closePath(),n.stroke()}e.tableXstr!==""&&(n.beginPath(),n.moveTo(0,0),n.fillText(e.tableXstr,13,e.offsetKeduY),n.stroke()),n.textAlign="center";for(var i=0;i<e.xlen;i++){n.beginPath();var o=i*e.unitWidth+e.startX;n.moveTo(o,t(e.keduHeight+2)),n.lineTo(o,e.keduHeight),n.moveTo(o,0),n.fillText(i*e.xUnit,o,e.offsetKeduY),n.stroke()}}var e={xUnit:1,yUnit:5e3,xlen:5,ylen:3,unitHeight:38,unitWidth:50,startX:0,tableXstr:"",beforeDraw:null,afterDraw:null,lines:[],offsetX:47,offsetY:23,tScale:window.devicePixelRatio,offsetKeduX:10,offsetKeduY:15,lineWidth:1,keduHeight:2,fontSize:14,pointR:3},n=function(t){var n=e;for(var r in t)n[r]=t[r]==="undefined"?n[r]:t[r];return n},a=function(e,t){this.canvasWraper=document.querySelector(e),this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d");var r=n(t),i=this;this.cfg=r,o.call(this),u.call(this),typeof this.cfg.beforeDraw=="function"&&this.cfg.beforeDraw.call(this),this.cfg.lines.forEach(function(e,t){e.beforeDraw.call(null,i.ctx),i.drawLine(e.points)}),this.canvasWraper.appendChild(this.canvas),typeof this.cfg.afterDraw=="function"&&this.cfg.afterDraw.call(this)},f=a.prototype;return f.drawLine=function(t){var n=this.ctx,r=this;n.beginPath(),t.forEach(function(e,t){var s=i.call(r,e);n.lineTo(s.x,s.y)}),n.stroke(),t.forEach(function(t,s){n.beginPath();var o=i.call(r,t);n.arc(o.x,o.y,e.pointR,0,Math.PI*2,!0),n.closePath(),n.fill()})},a});